# Configuration

## Prerequisites:

Install the following:

- [node](https://nodejs.org/en/download/)
- [ASP.Net Core SDK 2.1](https://www.microsoft.com/net/download)
- [Postgres](https://www.postgresql.org)  
  Mac: `brew cask install postgres`

## Database setup

Copy the file `appsettings.example.json` to `appsettings.json` and adapt the database settings according to your setup. The file can be found within the folder `Webspec3`.

Create the [database schema](Doc/Schema.sql) within your database.

## Development Environment

#### Backend

- Open The solution either in [Visual Studio](https://visualstudio.microsoft.com/de/?rr=https%3A%2F%2Fwww.google.de%2F), [Visual Studio Code](https://visualstudio.microsoft.com/de/?rr=https%3A%2F%2Fwww.google.de%2F) or [JetBrains Rider](https://www.jetbrains.com/rider/)
- Autogenerated Swagger UI is available at `/swagger` (development mode only)

##### Unittestss

Tests can be found within the project/folder `webspec3Tests`. Run them with `dotnet test` or from the IDE. An example service test can be found in `webspec3Tests/ProductServicesTest.cs`, an example controller test can be found in `webspec3Tests/LoginControllerTest.cs`.

#### Frontend

- The client app can be found in the folder _ClientApp_ within the folder _webspec3_
- First run `npm install`
- Build the app with `ng build` and `ng serve`

##### Unit- and Integrationtests

Tests can be found within the folder `Webspec3/ClientApp`. Run them with `npm run test`. To start the execution, click on `debug` in the opened browser. An example Unittest can be found in `Webspec3/ClientApp/src/app/services/storage.service.spec.ts`, an example Integrationtest can be found in `Webspec3/ClientApp/src/app/language-switcher/language-switcher.component.spec.ts`

##### Use Automated UI Testing

- Test framework protractor is already installed
- To start E2E tests simply execute "npm run e2e"
- Find test results in the console output

## Production environment

- Run `dotnet publish` to compile both the backend and frontend.
- There will be a folder `publish` within `bin/Debug/netcoreapp2.1`.
- You can run the app via `dotnet run path-to-bin/Debug/netcoreapp2.1/publish/webspec3.dll`
- We recommend using the provided systemd service template located in `webspec.service` and Apache2 as reverse proxy

# VM Instances

## Development

Johnny: `webspec61.mi.hdm-stuttgart.de`

Alex: `webspec62.mi.hdm-stuttgart.de`

Janina: `webspec63.mi.hdm-stuttgart.de`

Daniel: `webspec64.mi.hdm-stuttgart.de`

Maxi: `webspec65.mi.hdm-stuttgart.de`

## Production

`webspec66.mi.hdm-stuttgart.de`

# Nikto test

The result of the nikto test (`nikto -host https://webspec66.mi.hdm-stuttgart.de`) can be found in the file `NiktoTest.html`.
